{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "form-sheet",
  "title": "Form dialog",
  "dependencies": [
    "react-hook-form",
    "lucide-react",
    "uilab-core"
  ],
  "registryDependencies": [
    "https://ailabmn.gitlab.io/frontend/uilab/registry/r/confirmation.json"
  ],
  "files": [
    {
      "path": "registry/ionia/blocks/form-sheet.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { LoaderCircleIcon } from \"lucide-react\";\nimport { useFormContext } from \"react-hook-form\";\nimport {\n  Button,\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"uilab-core\";\nimport { useConfirmation } from \"@/registry/ionia/blocks/confirmation\";\n\n/**\n * Dialog boilerplate for forms.\n * It has confirmation dialog and everything you need in one component\n */\nexport function FormDialog({\n  title = \"\",\n  description = \"\",\n  trigger,\n  className,\n  children,\n  open: propOpen = false,\n  setOpen: propSetOpen,\n  isPending = false,\n  shouldConfirmDiscard = true,\n  discardTitle = \"Discard\",\n  discardDescription = \"Are you sure you want to discard? Your changes will not be saved!\",\n  discardCancelText = \"Cancel\",\n  discardConfirmText = \"Discard\",\n  cancelText = \"Cancel\",\n  confirmText = \"Confirm\",\n  onSubmit,\n}: {\n  /** Display title on sheet header */\n  title: string;\n  /** Display description on sheet header */\n  description?: string;\n  /** JSX Element (preferable with forwardRef command) for opening the sheet */\n  trigger?: React.ReactNode;\n  open?: boolean;\n  setOpen?: React.Dispatch<React.SetStateAction<boolean>>;\n  className?: string;\n  children: any;\n  isPending?: boolean;\n  /** Shows a dialog when clicked out confirming the user to discard */\n  shouldConfirmDiscard?: boolean;\n  /** Discard confirmation's dialog title */\n  discardTitle?: string;\n  /** Discard confirmation's description title */\n  discardDescription?: string;\n  /** Discard confirmation's cancel text */\n  discardCancelText?: string;\n  /** Discard confirmation's confirm text */\n  discardConfirmText?: string;\n  cancelText?: string;\n  confirmText?: string;\n  /**\n   * This prop should be async function for ease of handling success and error.\n   * Component uses [@tanstack/react-query](https://tanstack.com/query/latest) so you don't have to pass down additional `useMutation` methods\n   */\n  onSubmit?: (values: any) => Promise<void>;\n}) {\n  const form = useFormContext();\n  const [open, setOpen] = React.useState<boolean>(propOpen);\n  const { showDialog } = useConfirmation();\n\n  const toggleSheet = React.useCallback(\n    (open: boolean) => {\n      setOpen(open);\n      form.reset();\n      form.clearErrors();\n    },\n    [form, setOpen],\n  );\n\n  const handleOnChange = React.useCallback(\n    (isOpen: boolean) => {\n      if (Object.keys(form.formState.dirtyFields).length !== 0 && open) {\n        if (shouldConfirmDiscard) {\n          showDialog({\n            title: discardTitle,\n            description: discardDescription,\n            confirmText: discardConfirmText,\n            cancelText: discardCancelText,\n            onConfirm: () => toggleSheet(isOpen),\n          });\n        } else {\n          toggleSheet(isOpen);\n        }\n      } else {\n        toggleSheet(isOpen);\n      }\n    },\n    [form, open, showDialog, toggleSheet, shouldConfirmDiscard],\n  );\n\n  const handleSubmit = async (values: any) => {\n    if (onSubmit) {\n      await onSubmit(values).then(() => toggleSheet(false));\n    }\n  };\n\n  React.useEffect(() => propSetOpen && propSetOpen(open), [propSetOpen, open]);\n  React.useEffect(() => setOpen(propOpen), [propOpen]);\n\n  return (\n    <Dialog open={open} onOpenChange={handleOnChange}>\n      {trigger}\n      <DialogContent className={className}>\n        <DialogHeader>\n          <DialogTitle> {title} </DialogTitle>\n          <DialogDescription> {description} </DialogDescription>\n        </DialogHeader>\n        <form className=\"space-y-4\" onSubmit={form.handleSubmit(handleSubmit)}>\n          {children}\n          <button type=\"submit\" className=\"hidden\" />\n        </form>\n        <DialogFooter>\n          <Button\n            variant=\"outline\"\n            type=\"button\"\n            disabled={isPending}\n            onClick={(event) => {\n              event.preventDefault();\n              handleOnChange(false);\n            }}\n          >\n            {cancelText}\n          </Button>\n          <Button\n            type=\"button\"\n            disabled={isPending}\n            onClick={form.handleSubmit(handleSubmit)}\n          >\n            {isPending && <LoaderCircleIcon className=\"animate-spin\" />}\n            {confirmText}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n",
      "type": "registry:component",
      "target": "components/form-sheet.tsx"
    }
  ],
  "categories": [
    "sheet",
    "form"
  ],
  "type": "registry:block"
}