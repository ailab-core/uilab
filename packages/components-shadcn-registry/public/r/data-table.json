{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "data-table",
  "type": "registry:block",
  "title": "Data table",
  "description": "Common extendable data table for uilab",
  "dependencies": ["@tanstack/react-table", "lucide-react"],
  "registryDependencies": [
    "button",
    "table",
    "skeleton",
    "popover",
    "dropdown",
    "pagination"
  ],
  "files": [
    {
      "path": "src/components/blocks/data-table/advanced.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport {\n  flexRender,\n  getCoreRowModel,\n  useReactTable,\n} from \"@tanstack/react-table\"\nimport type { PaginationOptions, TableMeta } from \"@tanstack/react-table\"\nimport { RefreshCcwIcon } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\"\nimport { cn } from \"@/lib/utils\"\nimport type { DataColumn, DataPaginationState } from \".\"\nimport Pagination from \"./pagination\"\n\n/**\n * Advanced data tables that needs complex features such as Pagination, Filters, Column Hiding etc\n */\nexport function AdvancedDataTable({\n  data,\n  columns,\n  defaultColumn,\n  isFetching,\n  isCustomCell,\n  pagination,\n  paginationOptions = {},\n  refreshText = \"Refresh\",\n  noResultsText = \"No results\",\n  leftHeader,\n  rightHeader,\n  border = true,\n  meta,\n  refetch,\n}: {\n  /**\n   * Made to be fit with Pocket Pageable content response.\n   */\n  data: unknown[]\n  /**\n   * Collection of column definitions with\n   * [Tanstack Table](https://tanstack.com/table/latest/docs/api/core/column-def) standard\n   */\n  columns: DataColumn<any>[]\n  /**\n   * Default column options to use for all column defs supplied to the table.\n   */\n  defaultColumn?: DataColumn<any> | undefined\n  /**\n   * Component will render loader skeleton if `true`. Should be provided from `useQuery` from [Tanstack Query](https://tanstack.com/query/v4/docs/framework/react/reference/useQuery)\n   */\n  isFetching: boolean\n  /**\n   * You have to define TableCell in your column for more complex use cases\n   */\n  isCustomCell?: boolean\n  /**\n   * State of pagination to keep track. On tanstack table, `manualPagination` is `true`, so you can update the state whenever you call an api.\n   */\n  pagination?: DataPaginationState\n  /**\n   * Necessary for rendering `Pagination` component to keep track.\n   */\n  paginationOptions?: Pick<\n    PaginationOptions,\n    \"onPaginationChange\" | \"rowCount\" | \"pageCount\"\n  >\n  /**\n   * Refresh button text\n   */\n  refreshText?: string\n  /**\n   * No results text\n   */\n  noResultsText?: string\n  /**\n   * Element provided will be attached to the header's left side\n   */\n  leftHeader?: React.ReactNode\n  /**\n   * Element provided will be attached to the header's right side\n   */\n  rightHeader?: React.ReactNode\n  /**\n   * Additional data or method needed for the table\n   */\n  meta?: TableMeta<any>\n  /**\n   * Border around the table\n   */\n  border?: boolean\n  /**\n   * Optional if you want an action button that needs to reload api calls.\n   * Requires `isFetching` field and `refetch` function\n   * QOL component\n   */\n  refetch?: () => void\n}) {\n  const table = useReactTable({\n    data: data || [],\n    columns,\n    defaultColumn,\n    getCoreRowModel: getCoreRowModel(),\n    manualPagination: true,\n    ...paginationOptions,\n    initialState: { pagination },\n    meta,\n  })\n\n  const renderHeaders = React.useCallback(\n    () =>\n      table.getHeaderGroups().map((headerGroup) => (\n        <TableRow key={headerGroup.id}>\n          {headerGroup.headers.map((header) => (\n            <TableHead\n              className={header.id === \"action\" ? \"text-right\" : \"\"}\n              key={header.id}\n            >\n              {header.isPlaceholder\n                ? null\n                : flexRender(\n                    header.column.columnDef.header,\n                    header.getContext()\n                  )}\n            </TableHead>\n          ))}\n        </TableRow>\n      )),\n    [table]\n  )\n\n  return (\n    <div className=\"flex w-full flex-col gap-4\">\n      <div className=\"flex w-full items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          {leftHeader && leftHeader}\n        </div>\n        <div className=\"flex items-center justify-end gap-2\">\n          {rightHeader && rightHeader}\n          {refetch && (\n            <Button variant=\"outline\" onClick={refetch} disabled={isFetching}>\n              <RefreshCcwIcon /> {refreshText}\n            </Button>\n          )}\n        </div>\n      </div>\n      {isFetching ? (\n        <div className=\"flex w-full flex-col gap-2\">\n          <Skeleton className=\"h-7 w-full\" />\n          <Skeleton className=\"h-7 w-3/4\" />\n          <Skeleton className=\"h-7 w-1/2\" />\n        </div>\n      ) : (\n        <>\n          <div className={cn(\"rounded-lg\", border && \"border\")}>\n            <Table>\n              <TableHeader>{renderHeaders()}</TableHeader>\n              <TableBody>\n                {table.getRowModel().rows?.length ? (\n                  table.getRowModel().rows.map((row) => (\n                    <TableRow\n                      key={row.id}\n                      className={cn(\n                        row.id === \"actions\" && \"flex flex-row-reverse\"\n                      )}\n                      data-state={row.getIsSelected() && \"selected\"}\n                    >\n                      {row.getVisibleCells().map((cell) => {\n                        const render = flexRender(\n                          cell.column.columnDef.cell,\n                          cell.getContext()\n                        )\n\n                        return isCustomCell ? (\n                          render\n                        ) : (\n                          <TableCell\n                            className={cn(\n                              cell.column.id === \"actions\" &&\n                                \"flex flex-row-reverse\"\n                            )}\n                            key={cell.id}\n                          >\n                            {render}\n                          </TableCell>\n                        )\n                      })}\n                    </TableRow>\n                  ))\n                ) : (\n                  <TableRow>\n                    <TableCell\n                      colSpan={columns.length}\n                      className=\"h-24 text-center\"\n                    >\n                      {noResultsText}\n                    </TableCell>\n                  </TableRow>\n                )}\n              </TableBody>\n            </Table>\n          </div>\n          {pagination && <Pagination table={table} state={pagination} />}\n        </>\n      )}\n    </div>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/blocks/data-table/basic.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport {\n  flexRender,\n  getCoreRowModel,\n  useReactTable,\n  type TableMeta,\n} from \"@tanstack/react-table\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\"\nimport { cn } from \"@/lib/utils\"\nimport type { DataColumn } from \".\"\n\nexport function BasicDataTable({\n  data,\n  columns,\n  defaultColumn,\n  border = true,\n  noResultsText = \"No results\",\n  meta,\n  isFetching,\n  isCustomCell,\n}: {\n  /**\n   * Content to display\n   */\n  data: Array<any>\n  /**\n   * Collection of column definitions with\n   * [Tanstack Table](https://tanstack.com/table/latest/docs/api/core/column-def) standard\n   */\n  columns: DataColumn<any>[]\n  /**\n   * Default column options to use for all column defs supplied to the table.\n   */\n  defaultColumn?: DataColumn<any> | undefined\n  /**\n   * Border around the table\n   */\n  border?: boolean\n  /**\n   * No Results text\n   */\n  noResultsText?: string\n  /**\n   * Additional data or method needed for the table\n   */\n  meta?: TableMeta<any>\n  /**\n   * Component will render loader skeleton if `true`. Should be provided from `useQuery` from [Tanstack Query](https://tanstack.com/query/v4/docs/framework/react/reference/useQuery)\n   */\n  isFetching?: boolean\n  /**\n   * You have to define TableCell in your column for more complex use cases\n   */\n  isCustomCell?: boolean\n}) {\n  const table = useReactTable({\n    data: data || [],\n    columns,\n    defaultColumn,\n    meta,\n    getCoreRowModel: getCoreRowModel(),\n  })\n\n  const renderHeaders = React.useCallback(\n    () =>\n      table.getHeaderGroups().map((headerGroup) => (\n        <TableRow key={headerGroup.id}>\n          {headerGroup.headers.map((header) => (\n            <TableHead\n              className={header.id === \"action\" ? \"text-right\" : \"\"}\n              key={header.id}\n            >\n              {header.isPlaceholder\n                ? null\n                : flexRender(\n                    header.column.columnDef.header,\n                    header.getContext()\n                  )}\n            </TableHead>\n          ))}\n        </TableRow>\n      )),\n    [table]\n  )\n\n  if (isFetching) {\n    return (\n      <div className=\"flex w-full flex-col gap-2\">\n        <Skeleton className=\"h-7 w-full\" />\n        <Skeleton className=\"h-7 w-3/4\" />\n        <Skeleton className=\"h-7 w-1/2\" />\n      </div>\n    )\n  }\n\n  // Did not use `useReactTable` properties as it is broken\n  return (\n    <div className=\"w-full\">\n      <div className={cn(\"mb-2 rounded-lg\", border && \"border\")}>\n        <Table>\n          <TableHeader>{renderHeaders()}</TableHeader>\n          <TableBody>\n            {table.getRowModel().rows?.length ? (\n              table.getRowModel().rows.map((row) => (\n                <TableRow\n                  key={row.id}\n                  data-state={row.getIsSelected() && \"selected\"}\n                >\n                  {row.getVisibleCells().map((cell) => {\n                    const render = flexRender(\n                      cell.column.columnDef.cell,\n                      cell.getContext()\n                    )\n\n                    return isCustomCell ? (\n                      render\n                    ) : (\n                      <TableCell\n                        className={cn(\n                          cell.column.id === \"actions\" &&\n                            \"flex flex-row-reverse\"\n                        )}\n                        key={cell.id}\n                      >\n                        {render}\n                      </TableCell>\n                    )\n                  })}\n                </TableRow>\n              ))\n            ) : (\n              <TableRow>\n                <TableCell\n                  colSpan={columns.length}\n                  className=\"h-24 text-center\"\n                >\n                  {noResultsText}\n                </TableCell>\n              </TableRow>\n            )}\n          </TableBody>\n        </Table>\n      </div>\n    </div>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/blocks/data-table/filter-popover.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { FilterIcon } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\"\n\nexport function FilterPopover({\n  applied,\n  applyText = \"Apply\",\n  clearText = \"Clear\",\n  filterText = \"Filter\",\n  filterAppliedText = (applied: number) => `${applied} filter applied`,\n  children,\n  onSubmit,\n  onReset,\n}: {\n  /**\n   * Number of filters that is currently applied\n   * use `calculateAppliedFilters` function for ease of use\n   */\n  applied?: number\n  applyText?: string\n  clearText?: string\n  filterText?: string\n  filterAppliedText?: (applied: number) => string\n  children?: React.ReactNode\n  onSubmit?: () => Promise<void>\n  onReset?: () => any\n}) {\n  const [open, setOpen] = React.useState<boolean>(false)\n\n  const handleSubmit = () => {\n    if (onSubmit) onSubmit()\n    setOpen(false)\n  }\n\n  const handleClear = () => {\n    if (onReset) onReset()\n    setOpen(false)\n  }\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        <Button variant={applied !== 0 ? \"secondary\" : \"outline\"}>\n          <FilterIcon />\n          {applied !== 0 ? filterAppliedText(applied) : filterText}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent align=\"start\" className=\"w-xs space-y-3\">\n        <div className=\"grid w-full grid-cols-1 gap-3\">{children}</div>\n        <div className=\"flex flex-row-reverse gap-2\">\n          <Button type=\"button\" onClick={handleSubmit}>\n            {applyText}\n          </Button>\n          <Button type=\"button\" variant=\"outline\" onClick={handleClear}>\n            {clearText}\n          </Button>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/blocks/data-table/merged-cell.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { CellContext } from \"@tanstack/react-table\"\nimport { TableCell } from \"@/components/ui/table\"\nimport { cn } from \"@/lib/utils\"\n\n/**\n * In order to use this, you have to set `isCustomCell` to `true` in any form of table block component\n */\nexport function MergedCell({\n  context,\n  className,\n  children,\n  border = true,\n}: {\n  context: CellContext<any, unknown>\n  border?: boolean\n} & React.ComponentPropsWithoutRef<\"div\">) {\n  const { row, table, column } = context\n  const cell = row.original[column.id]\n  const rows = table.getRowModel().rows\n  const rowIndex = row.index\n\n  // Count how many rows have the same category starting from this row\n  let rowSpan = 1\n  if (rowIndex === 0 || rows[rowIndex - 1].original[column.id] !== cell) {\n    for (let i = rowIndex + 1; i < rows.length; i++) {\n      if (rows[i].original[column.id] === cell) {\n        rowSpan++\n      } else {\n        break\n      }\n    }\n\n    return (\n      <TableCell\n        rowSpan={rowSpan}\n        className={cn(className, border && \"border\")}\n      >\n        {children}\n      </TableCell>\n    )\n  }\n\n  return null\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/blocks/data-table/pagination.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { ChevronDownIcon } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\nimport {\n  Pagination,\n  PaginationContent,\n  PaginationNext,\n  PaginationPrevious,\n} from \"@/components/ui/pagination\"\nimport type { DataPaginationState, DataTable } from \".\"\n\nexport default React.memo(function TablePagination({\n  table,\n  state,\n  totalText = (total) => `Total of ${total} documents`,\n  pageText = (current, total) => `Page ${current}/${total}`,\n  rowsText = (rows) => `${rows} rows`,\n}: {\n  table: DataTable<unknown>\n  state: DataPaginationState\n  totalText: (total: string | number) => string\n  pageText: (current: string | number, total: string | number) => string\n  rowsText: (rows: string | number) => string\n}) {\n  // Tanstack methods are acting weird. I am actively working on it but for now this will do\n  const canPreviousPage = React.useCallback(\n    (): boolean => state.pageIndex > 0,\n    [state]\n  )\n  const canNextPage = React.useCallback(\n    (): boolean => state.pageIndex < table.getPageCount() - 1,\n    [state, table]\n  )\n\n  return (\n    <Pagination>\n      <PaginationContent className=\"w-full justify-between gap-6\">\n        <p className=\"text-muted-foreground text-sm\">\n          {totalText(table.getRowCount() || \"\")}\n        </p>\n        <div className=\"flex justify-center gap-6\">\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"outline\">\n                {rowsText(state.pageSize)}\n                <ChevronDownIcon className=\"stroke-muted-foreground\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              <DropdownMenuRadioGroup\n                value={state.pageSize.toString()}\n                onValueChange={(value: string) =>\n                  table.setPageSize(parseInt(value) || 20)\n                }\n              >\n                <DropdownMenuRadioItem value=\"10\">\n                  {rowsText(10)}\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"25\">\n                  {rowsText(25)}\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"50\">\n                  {rowsText(50)}\n                </DropdownMenuRadioItem>\n              </DropdownMenuRadioGroup>\n            </DropdownMenuContent>\n          </DropdownMenu>\n          <div className=\"flex items-center justify-center gap-2 text-sm\">\n            <span>\n              {pageText(\n                state.pageIndex + 1,\n                (table.getPageCount() || \"0\").toLocaleString()\n              )}\n            </span>\n          </div>\n          <div className=\"flex items-center gap-1 text-sm\">\n            <PaginationPrevious\n              onClick={() => table.previousPage()}\n              isActive={canPreviousPage()}\n            />\n            <PaginationNext\n              onClick={() => table.nextPage()}\n              isActive={canNextPage()}\n            />\n          </div>\n        </div>\n      </PaginationContent>\n    </Pagination>\n  )\n})\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/blocks/data-table/index.tsx",
      "content": "import type {\n  ColumnDef as TanColumnDef,\n  PaginationState as TanPaginationState,\n  Table as TanTable,\n} from \"@tanstack/react-table\"\n\nexport type DataTable<T> = TanTable<T>\nexport type DataColumn<T = unknown> = TanColumnDef<T>\nexport type DataPaginationState = TanPaginationState\n\nexport * from \"./advanced\"\nexport * from \"./basic\"\nexport * from \"./filter-popover\"\nexport * from \"./merged-cell\"\n",
      "type": "registry:component"
    }
  ]
}
